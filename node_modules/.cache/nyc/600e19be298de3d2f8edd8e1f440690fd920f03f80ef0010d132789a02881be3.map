{"version":3,"sources":["admin.js"],"names":["isAdmin","req","res","next","token","headers","authorization","split","body","decoded","jwt","verify","expiresIn","users","forEach","user","email","is_admin","status","send"],"mappings":";;;;;;;;;AAAA;;AACA;;AAEA;AACA,IAAMA,OAAO,GAAI,SAAXA,OAAW,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAE7B,MAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,aAAZ,CAA0BC,KAA1B,CAAgC,GAAhC,EAAqC,CAArC,KAA2CN,GAAG,CAACO,IAAJ,CAASJ,KAAlE;;AAEA,MAAMK,OAAO,GAAEC,yBAAIC,MAAJ,CAAWP,KAAX,EAAkB,oBAAlB,EAAwC;AAAEQ,IAAAA,SAAS,EAAE;AAAb,GAAxC,CAAf;;AAEAC,oBAAMC,OAAN,CAAc,UAACC,IAAD,EAAQ;AACtB,QAAGA,IAAI,CAACC,KAAL,KAAcP,OAAO,CAACO,KAAzB,EAA+B;AAC7B,UAAGP,OAAO,CAACQ,QAAX,EAAoB;AAClBd,QAAAA,IAAI;AACL;AACF;AACF,GANC;;AAQF,SAAOD,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAED,IAAAA,MAAM,EAAE,GAAV;AAAe,eAAU;AAAzB,GAArB,CAAP;AAED,CAhBL;;eAqBkBlB,O","sourceRoot":"/private/var/root/Documents/teamwork-backend/server/middleware","sourcesContent":["import jwt from 'jsonwebtoken';\nimport users from '../model/users'\n\n// to check if user is admin\nconst isAdmin =  (req, res, next) => {\n    \n        const token = req.headers.authorization.split(' ')[1] || req.body.token;\n\n        const decoded= jwt.verify(token, 'THIS IS MY SECRETE', { expiresIn: '7d' });\n    \n        users.forEach((user)=>{\n        if(user.email ===decoded.email){\n          if(decoded.is_admin){\n            next();\n          }\n        }\n      });\n\n      return res.status(401).send({ status: 401, 'message':'Unauthorized access'}); \n    \n    } \n    \n\n  \n  \n  export default  isAdmin;\n  "]}