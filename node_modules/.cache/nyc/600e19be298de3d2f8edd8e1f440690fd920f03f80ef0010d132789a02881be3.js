"use strict";var cov_1a6zdmmpqk=function(){var path="/private/var/root/Documents/teamwork-backend/server/middleware/admin.js";var hash="e91e7b30ba2d4bfe2d6e70be5f9dfbbfef541d01";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/private/var/root/Documents/teamwork-backend/server/middleware/admin.js",statementMap:{"0":{start:{line:3,column:29},end:{line:3,column:84}},"1":{start:{line:5,column:0},end:{line:7,column:3}},"2":{start:{line:8,column:0},end:{line:8,column:28}},"3":{start:{line:10,column:20},end:{line:10,column:67}},"4":{start:{line:12,column:13},end:{line:12,column:62}},"5":{start:{line:15,column:14},end:{line:34,column:1}},"6":{start:{line:16,column:14},end:{line:16,column:71}},"7":{start:{line:18,column:16},end:{line:20,column:4}},"8":{start:{line:22,column:2},end:{line:28,column:5}},"9":{start:{line:23,column:4},end:{line:27,column:5}},"10":{start:{line:24,column:6},end:{line:26,column:7}},"11":{start:{line:25,column:8},end:{line:25,column:15}},"12":{start:{line:30,column:2},end:{line:33,column:5}},"13":{start:{line:36,column:15},end:{line:36,column:22}},"14":{start:{line:37,column:0},end:{line:37,column:30}}},fnMap:{"0":{name:"isAdmin",decl:{start:{line:15,column:23},end:{line:15,column:30}},loc:{start:{line:15,column:47},end:{line:34,column:1}},line:15},"1":{name:"(anonymous_1)",decl:{start:{line:22,column:28},end:{line:22,column:29}},loc:{start:{line:22,column:44},end:{line:28,column:3}},line:22}},branchMap:{"0":{loc:{start:{line:16,column:14},end:{line:16,column:71}},type:"binary-expr",locations:[{start:{line:16,column:14},end:{line:16,column:53}},{start:{line:16,column:57},end:{line:16,column:71}}],line:16},"1":{loc:{start:{line:23,column:4},end:{line:27,column:5}},type:"if",locations:[{start:{line:23,column:4},end:{line:27,column:5}},{start:{line:23,column:4},end:{line:27,column:5}}],line:23},"2":{loc:{start:{line:24,column:6},end:{line:26,column:7}},type:"if",locations:[{start:{line:24,column:6},end:{line:26,column:7}},{start:{line:24,column:6},end:{line:26,column:7}}],line:24}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"e91e7b30ba2d4bfe2d6e70be5f9dfbbfef541d01"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();var _interopRequireDefault=(cov_1a6zdmmpqk.s[0]++,require("@babel/runtime/helpers/interopRequireDefault"));cov_1a6zdmmpqk.s[1]++;Object.defineProperty(exports,"__esModule",{value:true});cov_1a6zdmmpqk.s[2]++;exports["default"]=void 0;var _jsonwebtoken=(cov_1a6zdmmpqk.s[3]++,_interopRequireDefault(require("jsonwebtoken")));var _users=(cov_1a6zdmmpqk.s[4]++,_interopRequireDefault(require("../model/users")));// to check if user is admin
cov_1a6zdmmpqk.s[5]++;var isAdmin=function isAdmin(req,res,next){cov_1a6zdmmpqk.f[0]++;var token=(cov_1a6zdmmpqk.s[6]++,(cov_1a6zdmmpqk.b[0][0]++,req.headers.authorization.split(' ')[1])||(cov_1a6zdmmpqk.b[0][1]++,req.body.token));var decoded=(cov_1a6zdmmpqk.s[7]++,_jsonwebtoken["default"].verify(token,'THIS IS MY SECRETE',{expiresIn:'7d'}));cov_1a6zdmmpqk.s[8]++;_users["default"].forEach(function(user){cov_1a6zdmmpqk.f[1]++;cov_1a6zdmmpqk.s[9]++;if(user.email===decoded.email){cov_1a6zdmmpqk.b[1][0]++;cov_1a6zdmmpqk.s[10]++;if(decoded.is_admin){cov_1a6zdmmpqk.b[2][0]++;cov_1a6zdmmpqk.s[11]++;next();}else{cov_1a6zdmmpqk.b[2][1]++;}}else{cov_1a6zdmmpqk.b[1][1]++;}});cov_1a6zdmmpqk.s[12]++;return res.status(401).send({status:401,'message':'Unauthorized access'});};var _default=(cov_1a6zdmmpqk.s[13]++,isAdmin);cov_1a6zdmmpqk.s[14]++;exports["default"]=_default;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluLmpzIl0sIm5hbWVzIjpbImlzQWRtaW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwidG9rZW4iLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInNwbGl0IiwiYm9keSIsImRlY29kZWQiLCJqd3QiLCJ2ZXJpZnkiLCJleHBpcmVzSW4iLCJ1c2VycyIsImZvckVhY2giLCJ1c2VyIiwiZW1haWwiLCJpc19hZG1pbiIsInN0YXR1cyIsInNlbmQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUVBO0FBQ0EsSUFBTUEsT0FBTyxHQUFJLFNBQVhBLE9BQVcsQ0FBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQVdDLElBQVgsRUFBb0I7QUFFN0IsTUFBTUMsS0FBSyxHQUFHSCxHQUFHLENBQUNJLE9BQUosQ0FBWUMsYUFBWixDQUEwQkMsS0FBMUIsQ0FBZ0MsR0FBaEMsRUFBcUMsQ0FBckMsS0FBMkNOLEdBQUcsQ0FBQ08sSUFBSixDQUFTSixLQUFsRTs7QUFFQSxNQUFNSyxPQUFPLEdBQUVDLHlCQUFJQyxNQUFKLENBQVdQLEtBQVgsRUFBa0Isb0JBQWxCLEVBQXdDO0FBQUVRLElBQUFBLFNBQVMsRUFBRTtBQUFiLEdBQXhDLENBQWY7O0FBRUFDLG9CQUFNQyxPQUFOLENBQWMsVUFBQ0MsSUFBRCxFQUFRO0FBQ3RCLFFBQUdBLElBQUksQ0FBQ0MsS0FBTCxLQUFjUCxPQUFPLENBQUNPLEtBQXpCLEVBQStCO0FBQzdCLFVBQUdQLE9BQU8sQ0FBQ1EsUUFBWCxFQUFvQjtBQUNsQmQsUUFBQUEsSUFBSTtBQUNMO0FBQ0Y7QUFDRixHQU5DOztBQVFGLFNBQU9ELEdBQUcsQ0FBQ2dCLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUFFRCxJQUFBQSxNQUFNLEVBQUUsR0FBVjtBQUFlLGVBQVU7QUFBekIsR0FBckIsQ0FBUDtBQUVELENBaEJMOztlQXFCa0JsQixPIiwic291cmNlUm9vdCI6Ii9wcml2YXRlL3Zhci9yb290L0RvY3VtZW50cy90ZWFtd29yay1iYWNrZW5kL3NlcnZlci9taWRkbGV3YXJlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xuaW1wb3J0IHVzZXJzIGZyb20gJy4uL21vZGVsL3VzZXJzJ1xuXG4vLyB0byBjaGVjayBpZiB1c2VyIGlzIGFkbWluXG5jb25zdCBpc0FkbWluID0gIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIFxuICAgICAgICBjb25zdCB0b2tlbiA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24uc3BsaXQoJyAnKVsxXSB8fCByZXEuYm9keS50b2tlbjtcblxuICAgICAgICBjb25zdCBkZWNvZGVkPSBqd3QudmVyaWZ5KHRva2VuLCAnVEhJUyBJUyBNWSBTRUNSRVRFJywgeyBleHBpcmVzSW46ICc3ZCcgfSk7XG4gICAgXG4gICAgICAgIHVzZXJzLmZvckVhY2goKHVzZXIpPT57XG4gICAgICAgIGlmKHVzZXIuZW1haWwgPT09ZGVjb2RlZC5lbWFpbCl7XG4gICAgICAgICAgaWYoZGVjb2RlZC5pc19hZG1pbil7XG4gICAgICAgICAgICBuZXh0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5zZW5kKHsgc3RhdHVzOiA0MDEsICdtZXNzYWdlJzonVW5hdXRob3JpemVkIGFjY2Vzcyd9KTsgXG4gICAgXG4gICAgfSBcbiAgICBcblxuICBcbiAgXG4gIGV4cG9ydCBkZWZhdWx0ICBpc0FkbWluO1xuICAiXX0=