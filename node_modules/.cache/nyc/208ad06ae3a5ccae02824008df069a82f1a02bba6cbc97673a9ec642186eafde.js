"use strict";var cov_1a6zdmmpqk=function(){var path="/private/var/root/Documents/teamwork-backend/server/middleware/admin.js";var hash="fb390c0fddfa250d27cb3ecf914983467046d310";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/private/var/root/Documents/teamwork-backend/server/middleware/admin.js",statementMap:{"0":{start:{line:3,column:29},end:{line:3,column:84}},"1":{start:{line:5,column:0},end:{line:7,column:3}},"2":{start:{line:8,column:0},end:{line:8,column:28}},"3":{start:{line:10,column:20},end:{line:10,column:67}},"4":{start:{line:12,column:13},end:{line:12,column:62}},"5":{start:{line:15,column:14},end:{line:36,column:1}},"6":{start:{line:16,column:14},end:{line:16,column:71}},"7":{start:{line:18,column:16},end:{line:20,column:4}},"8":{start:{line:22,column:2},end:{line:22,column:23}},"9":{start:{line:24,column:2},end:{line:30,column:5}},"10":{start:{line:25,column:4},end:{line:29,column:5}},"11":{start:{line:26,column:6},end:{line:28,column:7}},"12":{start:{line:27,column:8},end:{line:27,column:15}},"13":{start:{line:32,column:2},end:{line:35,column:5}},"14":{start:{line:38,column:15},end:{line:38,column:22}},"15":{start:{line:39,column:0},end:{line:39,column:30}}},fnMap:{"0":{name:"isAdmin",decl:{start:{line:15,column:23},end:{line:15,column:30}},loc:{start:{line:15,column:47},end:{line:36,column:1}},line:15},"1":{name:"(anonymous_1)",decl:{start:{line:24,column:28},end:{line:24,column:29}},loc:{start:{line:24,column:44},end:{line:30,column:3}},line:24}},branchMap:{"0":{loc:{start:{line:16,column:14},end:{line:16,column:71}},type:"binary-expr",locations:[{start:{line:16,column:14},end:{line:16,column:53}},{start:{line:16,column:57},end:{line:16,column:71}}],line:16},"1":{loc:{start:{line:25,column:4},end:{line:29,column:5}},type:"if",locations:[{start:{line:25,column:4},end:{line:29,column:5}},{start:{line:25,column:4},end:{line:29,column:5}}],line:25},"2":{loc:{start:{line:26,column:6},end:{line:28,column:7}},type:"if",locations:[{start:{line:26,column:6},end:{line:28,column:7}},{start:{line:26,column:6},end:{line:28,column:7}}],line:26}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"fb390c0fddfa250d27cb3ecf914983467046d310"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();var _interopRequireDefault=(cov_1a6zdmmpqk.s[0]++,require("@babel/runtime/helpers/interopRequireDefault"));cov_1a6zdmmpqk.s[1]++;Object.defineProperty(exports,"__esModule",{value:true});cov_1a6zdmmpqk.s[2]++;exports["default"]=void 0;var _jsonwebtoken=(cov_1a6zdmmpqk.s[3]++,_interopRequireDefault(require("jsonwebtoken")));var _users=(cov_1a6zdmmpqk.s[4]++,_interopRequireDefault(require("../model/users")));// to check if user is admin
cov_1a6zdmmpqk.s[5]++;var isAdmin=function isAdmin(req,res,next){cov_1a6zdmmpqk.f[0]++;var token=(cov_1a6zdmmpqk.s[6]++,(cov_1a6zdmmpqk.b[0][0]++,req.headers.authorization.split(' ')[1])||(cov_1a6zdmmpqk.b[0][1]++,req.body.token));var decoded=(cov_1a6zdmmpqk.s[7]++,_jsonwebtoken["default"].verify(token,'THIS IS MY SECRETE',{expiresIn:'7d'}));cov_1a6zdmmpqk.s[8]++;console.log(decoded);cov_1a6zdmmpqk.s[9]++;_users["default"].forEach(function(user){cov_1a6zdmmpqk.f[1]++;cov_1a6zdmmpqk.s[10]++;if(user.email===decoded.email){cov_1a6zdmmpqk.b[1][0]++;cov_1a6zdmmpqk.s[11]++;if(decoded.is_admin){cov_1a6zdmmpqk.b[2][0]++;cov_1a6zdmmpqk.s[12]++;next();}else{cov_1a6zdmmpqk.b[2][1]++;}}else{cov_1a6zdmmpqk.b[1][1]++;}});cov_1a6zdmmpqk.s[13]++;return res.status(401).send({status:401,'message':'Unauthorized access'});};var _default=(cov_1a6zdmmpqk.s[14]++,isAdmin);cov_1a6zdmmpqk.s[15]++;exports["default"]=_default;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluLmpzIl0sIm5hbWVzIjpbImlzQWRtaW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwidG9rZW4iLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInNwbGl0IiwiYm9keSIsImRlY29kZWQiLCJqd3QiLCJ2ZXJpZnkiLCJleHBpcmVzSW4iLCJjb25zb2xlIiwibG9nIiwidXNlcnMiLCJmb3JFYWNoIiwidXNlciIsImVtYWlsIiwiaXNfYWRtaW4iLCJzdGF0dXMiLCJzZW5kIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFFQTtBQUNBLElBQU1BLE9BQU8sR0FBSSxTQUFYQSxPQUFXLENBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFXQyxJQUFYLEVBQW9CO0FBRTdCLE1BQU1DLEtBQUssR0FBR0gsR0FBRyxDQUFDSSxPQUFKLENBQVlDLGFBQVosQ0FBMEJDLEtBQTFCLENBQWdDLEdBQWhDLEVBQXFDLENBQXJDLEtBQTJDTixHQUFHLENBQUNPLElBQUosQ0FBU0osS0FBbEU7O0FBRUEsTUFBTUssT0FBTyxHQUFFQyx5QkFBSUMsTUFBSixDQUFXUCxLQUFYLEVBQWtCLG9CQUFsQixFQUF3QztBQUFFUSxJQUFBQSxTQUFTLEVBQUU7QUFBYixHQUF4QyxDQUFmOztBQUNBQyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUwsT0FBWjs7QUFDRk0sb0JBQU1DLE9BQU4sQ0FBYyxVQUFDQyxJQUFELEVBQVE7QUFDcEIsUUFBR0EsSUFBSSxDQUFDQyxLQUFMLEtBQWNULE9BQU8sQ0FBQ1MsS0FBekIsRUFBK0I7QUFDN0IsVUFBR1QsT0FBTyxDQUFDVSxRQUFYLEVBQW9CO0FBQ2xCaEIsUUFBQUEsSUFBSTtBQUNMO0FBQ0Y7QUFDRixHQU5EOztBQVFBLFNBQU9ELEdBQUcsQ0FBQ2tCLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUFFRCxJQUFBQSxNQUFNLEVBQUUsR0FBVjtBQUFlLGVBQVU7QUFBekIsR0FBckIsQ0FBUDtBQUVELENBaEJMOztlQXFCa0JwQixPIiwic291cmNlUm9vdCI6Ii9wcml2YXRlL3Zhci9yb290L0RvY3VtZW50cy90ZWFtd29yay1iYWNrZW5kL3NlcnZlci9taWRkbGV3YXJlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xuaW1wb3J0IHVzZXJzIGZyb20gJy4uL21vZGVsL3VzZXJzJ1xuXG4vLyB0byBjaGVjayBpZiB1c2VyIGlzIGFkbWluXG5jb25zdCBpc0FkbWluID0gIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIFxuICAgICAgICBjb25zdCB0b2tlbiA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24uc3BsaXQoJyAnKVsxXSB8fCByZXEuYm9keS50b2tlbjtcblxuICAgICAgICBjb25zdCBkZWNvZGVkPSBqd3QudmVyaWZ5KHRva2VuLCAnVEhJUyBJUyBNWSBTRUNSRVRFJywgeyBleHBpcmVzSW46ICc3ZCcgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKGRlY29kZWQpO1xuICAgICAgdXNlcnMuZm9yRWFjaCgodXNlcik9PntcbiAgICAgICAgaWYodXNlci5lbWFpbCA9PT1kZWNvZGVkLmVtYWlsKXtcbiAgICAgICAgICBpZihkZWNvZGVkLmlzX2FkbWluKXtcbiAgICAgICAgICAgIG5leHQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoeyBzdGF0dXM6IDQwMSwgJ21lc3NhZ2UnOidVbmF1dGhvcml6ZWQgYWNjZXNzJ30pOyBcbiAgICBcbiAgICB9IFxuICAgIFxuXG4gIFxuICBcbiAgZXhwb3J0IGRlZmF1bHQgIGlzQWRtaW47XG4gICJdfQ==