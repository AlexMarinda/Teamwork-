{"version":3,"sources":["user.js"],"names":["chai","use","chaiHttp","should","expect","assert","users","user1","describe","before","initDB","it","done","request","app","post","send","email","first_name","last_name","password","gender","jobRole","department","address","end","err","res","have","status","body","property","be","a","eql","timeout","patch","price","token","set"],"mappings":";;;;;;;;;;AACA;;AACA;;AACA;;AACA;;AAJA;AAOAA,iBAAKC,GAAL,CAASC,oBAAT;;AACAF,iBAAKG,MAAL,G,CACA;;;IACQC,M,GAAmBJ,gB,CAAnBI,M;IAAQC,M,GAAWL,gB,CAAXK,M;;6CACAC,kB;IAATC,K;;AAEPC,QAAQ,CAAC,iBAAD,EAAoB,YAAM;AAChCC,EAAAA,MAAM;AAAA;AAAA;AAAA;AAAA,+BAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACCC,MAAM,EADP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD,GAAN;AAGAF,EAAAA,QAAQ,CAAC,QAAD,EAAW,YAAM;AACvBG,IAAAA,EAAE,CAAC,gDAAD,EAAmD,UAAAC,IAAI,EAAI;AAC3DZ,uBACGa,OADH,CACWC,iBADX,EAEGC,IAFH,CAEQ,qBAFR,EAGGC,IAHH,CAGQ;AACFC,QAAAA,KAAK,EAAE,wBADL;AAEFC,QAAAA,UAAU,EAAE,QAFV;AAGFC,QAAAA,SAAS,EAAE,SAHT;AAIFC,QAAAA,QAAQ,EAAE,KAJR;AAKFC,QAAAA,MAAM,EAAE,MALN;AAMFC,QAAAA,OAAO,EAAE,WANP;AAOFC,QAAAA,UAAU,EAAE,IAPV;AAQFC,QAAAA,OAAO,EAAE;AARP,OAHR,EAaGC,GAbH,CAaO,UAACC,GAAD,EAAMC,GAAN,EAAc;AACjBA,QAAAA,GAAG,CAACxB,MAAJ,CAAWyB,IAAX,CAAgBC,MAAhB,CAAuB,GAAvB;AACAF,QAAAA,GAAG,CAACG,IAAJ,CAAS3B,MAAT,CAAgByB,IAAhB,CAAqBG,QAArB,CAA8B,MAA9B,EAAsCC,EAAtC,CAAyCC,CAAzC,CAA2C,QAA3C;AACAN,QAAAA,GAAG,CAACG,IAAJ,CAAS3B,MAAT,CAAgByB,IAAhB,CAAqBG,QAArB,CAA8B,MAA9B,EAAsCH,IAAtC,CAA2CG,QAA3C,CAAoD,OAApD;AACAnB,QAAAA,IAAI;AACL,OAlBH;AAmBD,KApBC,CAAF;AAsBAD,IAAAA,EAAE,CAAC,mDAAD,EAAsD,UAAAC,IAAI,EAAI;AAC9DZ,uBACGa,OADH,CACWC,iBADX,EAEGC,IAFH,CAEQ,qBAFR,EAGGC,IAHH,CAGQ;AACFC,QAAAA,KAAK,EAAE,yBADL;AAEFC,QAAAA,UAAU,EAAE,QAFV;AAGFC,QAAAA,SAAS,EAAE,SAHT;AAIFC,QAAAA,QAAQ,EAAE,KAJR;AAKFC,QAAAA,MAAM,EAAE,MALN;AAMFC,QAAAA,OAAO,EAAE,WANP;AAOFC,QAAAA,UAAU,EAAE,IAPV;AAQFC,QAAAA,OAAO,EAAE;AARP,OAHR,EAaGC,GAbH,CAaO,UAACC,GAAD,EAAMC,GAAN,EAAc;AACjBA,QAAAA,GAAG,CAACxB,MAAJ,CAAWyB,IAAX,CAAgBC,MAAhB,CAAuB,GAAvB;AACAF,QAAAA,GAAG,CAACG,IAAJ,CAAS3B,MAAT,CAAgByB,IAAhB,CAAqBG,QAArB,CAA8B,SAA9B,EAAyCG,GAAzC,CAA6C,qCAA7C;AACAtB,QAAAA,IAAI;AACL,OAjBH;AAkBD,KAnBC,CAAF;AAoBD,GA3CO,CAAR;AA4CAJ,EAAAA,QAAQ,CAAC,QAAD,EAAW,YAAM;AACvBG,IAAAA,EAAE,CAAC,wDAAD,EAA2D,UAAAC,IAAI,EAAI;AACnEZ,uBACGa,OADH,CACWC,iBADX,EAEGC,IAFH,CAEQ,qBAFR,EAGGC,IAHH,CAGQ;AACJC,QAAAA,KAAK,EAAEV,KAAK,CAACU,KADT;AAEJG,QAAAA,QAAQ,EAAE;AAFN,OAHR,EAOGK,GAPH,CAOO,UAACC,GAAD,EAAMC,GAAN,EAAc;AACjBA,QAAAA,GAAG,CAACxB,MAAJ,CAAWyB,IAAX,CAAgBC,MAAhB,CAAuB,GAAvB;AACAF,QAAAA,GAAG,CAACG,IAAJ,CAAS3B,MAAT,CAAgByB,IAAhB,CAAqBG,QAArB,CAA8B,QAA9B,EAAwCC,EAAxC,CAA2CC,CAA3C,CAA6C,QAA7C;AACAN,QAAAA,GAAG,CAACG,IAAJ,CAAS3B,MAAT,CAAgByB,IAAhB,CAAqBG,QAArB,CAA8B,QAA9B,EAAwCG,GAAxC,CAA4C,SAA5C;AACAP,QAAAA,GAAG,CAACG,IAAJ,CAAS3B,MAAT,CAAgByB,IAAhB,CAAqBG,QAArB,CAA8B,MAA9B,EAAsCC,EAAtC,CAAyCC,CAAzC,CAA2C,QAA3C;AACAN,QAAAA,GAAG,CAACG,IAAJ,CAAS3B,MAAT,CAAgByB,IAAhB,CAAqBG,QAArB,CAA8B,MAA9B,EAAsCH,IAAtC,CAA2CG,QAA3C,CAAoD,OAApD;AACAnB,QAAAA,IAAI;AACL,OAdH;AAeD,KAhBC,CAAF,CAgBGuB,OAhBH,CAgBW,IAhBX;AAkBAxB,IAAAA,EAAE,CAAC,kDAAD,EAAqD,UAAAC,IAAI,EAAI;AAC7DZ,uBACGa,OADH,CACWC,iBADX,EAEGC,IAFH,CAEQ,qBAFR,EAGGC,IAHH,CAGQ;AACJC,QAAAA,KAAK,EAAE,eADH;AAEJG,QAAAA,QAAQ,EAAE;AAFN,OAHR,EAOGK,GAPH,CAOO,UAACC,GAAD,EAAMC,GAAN,EAAc;AACjBA,QAAAA,GAAG,CAACxB,MAAJ,CAAWyB,IAAX,CAAgBC,MAAhB,CAAuB,GAAvB;AACAF,QAAAA,GAAG,CAACG,IAAJ,CAAS3B,MAAT,CAAgByB,IAAhB,CAAqBG,QAArB,CAA8B,MAA9B,EAAsCC,EAAtC,CAAyCC,CAAzC,CAA2C,QAA3C;AACAN,QAAAA,GAAG,CAACG,IAAJ,CAAS3B,MAAT,CAAgByB,IAAhB,CAAqBG,QAArB,CAA8B,MAA9B,EAAsCG,GAAtC,CAA0C,2BAA1C;AACAtB,QAAAA,IAAI;AACL,OAZH;AAaD,KAdC,CAAF;AAeD,GAlCO,CAAR;AAmCAJ,EAAAA,QAAQ,CAAC,KAAD,EAAQ,YAAM;AACpBG,IAAAA,EAAE,CAAC,kEAAD,EAAqE,UAAAC,IAAI,EAAI;AAC7EZ,uBACGa,OADH,CACWC,iBADX,EAEGsB,KAFH,CAES,oBAFT,EAGGpB,IAHH,CAGQ;AACJqB,QAAAA,KAAK,EAAE;AADH,OAHR,EAMGZ,GANH,CAMO,UAACC,GAAD,EAAMC,GAAN,EAAc;AACjBA,QAAAA,GAAG,CAACxB,MAAJ,CAAWyB,IAAX,CAAgBC,MAAhB,CAAuB,GAAvB;AACAF,QAAAA,GAAG,CAACG,IAAJ,CAAS3B,MAAT,CAAgByB,IAAhB,CAAqBG,QAArB,CAA8B,SAA9B,EAAyCG,GAAzC,CAA6C,wBAA7C;AACAtB,QAAAA,IAAI;AACL,OAVH;AAWD,KAZC,CAAF;AAaAD,IAAAA,EAAE,CAAC,+DAAD,EAAkE,UAAAC,IAAI,EAAI;AAC1E,UAAM0B,KAAK,4SAAX;;AACAtC,uBACGa,OADH,CACWC,iBADX,EAEGsB,KAFH,CAES,oBAFT,EAGGG,GAHH,CAGO,eAHP,mBAGkCD,KAHlC,GAIGtB,IAJH,CAIQ;AACJqB,QAAAA,KAAK,EAAE;AADH,OAJR,EAOGZ,GAPH,CAOO,UAACC,GAAD,EAAMC,GAAN,EAAc;AACjBA,QAAAA,GAAG,CAACxB,MAAJ,CAAWyB,IAAX,CAAgBC,MAAhB,CAAuB,GAAvB;AACAF,QAAAA,GAAG,CAACG,IAAJ,CAAS3B,MAAT,CAAgByB,IAAhB,CAAqBG,QAArB,CAA8B,OAA9B;AACAnB,QAAAA,IAAI;AACL,OAXH;AAYD,KAdC,CAAF;AAeD,GA7BO,CAAR;AA8BD,CAjHO,CAAR","sourceRoot":"/private/var/root/Documents/teamwork-backend/server/test","sourcesContent":["// Import the dependencies for testing\nimport chai from 'chai';\nimport chaiHttp from 'chai-http';\nimport app from '../index';\nimport users from '../model/users';\n\n\nchai.use(chaiHttp);\nchai.should();\n// eslint-disable-next-line no-unused-vars\nconst { expect, assert } = chai;\nconst [user1] = users;\n\ndescribe('Authentications', () => {\n  before(async () => {\n    await initDB();\n  });\n  describe('SignUp', () => {\n    it('it should add user if required fields provided', done => {\n      chai\n        .request(app)\n        .post('/api/v1/auth/signup')\n        .send({\n            email: 'marindaalex4@gmail.com',\n            first_name: 'teller',\n            last_name: 'marinda',\n            password: '123',\n            gender: 'male',\n            jobRole :'developer',\n            department :'IT',\n            address: 'kicukiro',\n        })\n        .end((err, res) => {\n          res.should.have.status(201);\n          res.body.should.have.property('data').be.a('object');\n          res.body.should.have.property('data').have.property('token');\n          done();\n        });\n    });\n\n    it('it should return 409 when user choose email taken', done => {\n      chai\n        .request(app)\n        .post('/api/v1/auth/signup')\n        .send({\n            email: 'marindaalex44@gmail.com',\n            first_name: 'teller',\n            last_name: 'marinda',\n            password: '123',\n            gender: 'male',\n            jobRole :'developer',\n            department :'IT',\n            address: 'kicukiro',\n        })\n        .end((err, res) => {\n          res.should.have.status(409);\n          res.body.should.have.property('message').eql('choose another email this was taken');\n          done();\n        });\n    });\n  });\n  describe('SignIn', () => {\n    it('it should sign in user if correct credentials provided', done => {\n      chai\n        .request(app)\n        .post('/api/v2/auth/signin')\n        .send({\n          email: user1.email,\n          password: 'c00lssap'\n        })\n        .end((err, res) => {\n          res.should.have.status(200);\n          res.body.should.have.property('status').be.a('string');\n          res.body.should.have.property('status').eql('success');\n          res.body.should.have.property('data').be.a('object');\n          res.body.should.have.property('data').have.property('token');\n          done();\n        });\n    }).timeout(5000);\n\n    it('it should return 400  when user fills bad inputs', done => {\n      chai\n        .request(app)\n        .post('/api/v2/auth/signin')\n        .send({\n          email: 'test@test.com',\n          password: 'somebadpass'\n        })\n        .end((err, res) => {\n          res.should.have.status(400);\n          res.body.should.have.property('data').be.a('string');\n          res.body.should.have.property('data').eql('invalid email or password');\n          done();\n        });\n    });\n  });\n  describe('JWT', () => {\n    it('it should return 401 if missing jwt token on authenticated route', done => {\n      chai\n        .request(app)\n        .patch('/api/v2/property/1')\n        .send({\n          price: 100\n        })\n        .end((err, res) => {\n          res.should.have.status(401);\n          res.body.should.have.property('message').eql('Authentication failed!');\n          done();\n        });\n    });\n    it('it should return 400 if you jwt bad or malformatted jwt token', done => {\n      const token = `eyJhbGciOiJIUzI1NiIsInR5cCI6ImFjY2VzcyJ9.eyJ1c2VySWQiOjMsImlhdCI6MTU1Nzg3NzExNywiZXhwIjoxNTU3OTYzNTE3LCJhdWQiOiJodHRwczovL3lvdXJkb21haW4uY29tIiwiaXNzIjoiZmVhdGhlcnMiLCJzdWIiOiJhbm9ueW1vdXMiLCJqdGkiOiJkNDhjMDY1My01NDZjLTQ2N2EtYmU2Yi1iYmI2ZDgxNTc5NzcifQ.zlQIVtjBPC73AOUh_Gl1sCkNTS3SBonmoeSLzghHgok`;\n      chai\n        .request(app)\n        .patch('/api/v2/property/1')\n        .set('Authorization', `Bearer ${token}`)\n        .send({\n          price: 100\n        })\n        .end((err, res) => {\n          res.should.have.status(400);\n          res.body.should.have.property('error');\n          done();\n        });\n    });\n  });\n});\n"]}